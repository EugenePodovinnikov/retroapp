package com.microservice.services;

import kong.unirest.HttpResponse;
import kong.unirest.JsonNode;
import kong.unirest.Unirest;
import lombok.Setter;
import org.springframework.stereotype.Component;

import static com.microservice.resources.Constants.Headers.AUTORIZATION;
import static com.microservice.utilities.StringUtils.StringFunctions.ADD_ACCESS_TOKEN_TO_HEADER;
import static com.microservice.utilities.StringUtils.StringFunctions.ADD_SEARCH_QUERY_TO_REQUEST;


@Component
public class EbayCrawlerService {

    @Setter
    public static String token = "v^1.1#i^1#p^1#I^3#f^0#r^0#t^H4sIAAAAAAAAAOVYbWwURRju9a6FAgWjBgWUHFtQAuzd7N7t3t3KXTx6LZy0vZbrFVqrZHdvtizd21125mgvJlCb2GDEGIwawWgqCT+MREGDIXyk8scf+EkiHwYlGvwhfxBMEI1p4uzdUa6VANJLbOL9ucw777zzPM+878zsgIHqmmVDa4au1zqmVQ4PgIFKh4OZCWqqq5bPdlbOr6oAJQ6O4YHFA65B5y8rkZjRTGEdRKahI+juz2g6EvLGMJW1dMEQkYoEXcxAJGBZSEabmwTWAwTTMrAhGxrljsfCVID1Bzk2wIqcT5SgFCRW/UbMdiNMiRyr8EyaY4Myy0r+AOlHKAvjOsKijsMUC1iWBiGa4dqZkOBjBIb3sAzTRbk7oIVUQycuHkBF8nCF/FirBOvtoYoIQQuTIFQkHm1MJqLxWENL+0pvSaxIUYckFnEWjW/VG2no7hC1LLz9NCjvLSSzsgwRoryRwgzjgwrRG2DuAX5B6iDPAF4ReUaRWRHAskjZaFgZEd8eh21R07SSdxWgjlWcu5OiRA1pM5RxsdVCQsRjbvuvLStqqqJCK0w1rIp2RltbSSy4tQfqqkpbEFuGaJp067oY7fP5ggG/xKRpBvh5OQRAcaJCtKLME2aqN/S0aouG3C0GXgUJajhRG7ZEG+KU0BNWVME2ohI/4lTUEPi67EUtrGIWb9LtdYUZIoQ737zzCoyNxthSpSyGYxEmduQlImVjmmqamtiZz8Vi+vSjMLUJY1Pwevv6+jx9Po9h9XhZABjvhuampLwJZkSK+Nq1XvBX7zyAVvNUZJJbxF/AOZNg6Se5SgDoPVTEz/s5H1PUfTysyETrPwwlnL3jK6JcFUL0D0os5Hnol2VZYstRIZFiknptHFASc3RGtHohNjVRhrRM8iybgZaaFnycwvqCCqTTfEih/SFFoSUuzdOMAiGAUJLkUPD/VCh3m+pJKBMyZcn1suW53NO/Ltbp731qvZ7iE2pLWk1yQMsm126Rk7DNW78hxMBOb1ILgXj4bqvhluTrNZUo007mL4cAdq2XT4Q1BsIwPSl6SdkwYauhqXJuai2wz0q3ihbOJaGmEcOkSEZNM16evbps9P7lNnFvvMt3Rv1H59MtWSE7ZacWK3s8IgFEU/XYJ5BHNjJeu9YNkVw/bPPGPOpJ8VbJzXVKsSYkC2zVdOHK6cnT9aCtsseCyMha5LbtSdg3sHajF+rkPCO5rmnQ6phcBtj1nMlksShpcKoVdhkSXBWn2GHL8LyPDQA2wE+Kl5w/SjdOtS2pHFuxa/U9Xqu94z/yIxX5HzPoOAQGHQcrHQ7gBUuYOrCo2plyOWfNRyqGHlVUPEjt0cm3qwU9vTBniqpVWe3Y1iy0nS55Vhh+Bjw89rBQ42RmlrwygEdu9lQxcx6qZVkQYjgm5GMYvgvU3ex1MXNdD2r7dn9X8eGOd06y3x5p3LVrjq/7SQ3Ujjk5HFUVrkFHBX1sVVPnl03q03Xn9qwA87r/+vrwp5eOjt536vzuq4dqXRe6FuNGjnKenu968bg87aXprduXX5wmX9n7xf5Tj78w+gAbrbj4x1D3Sa5l3/OxJdfEzvfYy3uPXT+z42T2DLfi/VmHqbfQJ5UHOs6mTi9t6P5xyYKFo+dHzvw2/ZWhRPOBDWe3HHl2xmMj89qew3vDr47ej5ZePfHTry+/Pjga3a6tD8DEvv43U5uvdExv+Lm24dxI5LPPvzkV3v7R8Mc1q/ePXnIcr5VfuzQ3tsy58NrBVK7pxKEffv+gfeui9V/Ra3Yvup7q3/nGBbVpj3I5Vff90aP8u9zs82t3vD3jxDapw/HEoyMzF2AO/VlYvr8B5m1Yg/ARAAA=";

    public JsonNode searchForConsole(String query) {
        HttpResponse<JsonNode> jsonResponse = Unirest.get(ADD_SEARCH_QUERY_TO_REQUEST.apply(query))
                .header(AUTORIZATION, ADD_ACCESS_TOKEN_TO_HEADER.apply(token)).asJson();
        return jsonResponse.getBody();
    }
}
